---
title: "Homework01"
author: "Manpreet S. Katari"
date: "9/16/2021"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Homework 1					                           

## DUE: 09/23/21

Please submit your R code and functions in one file. 

Remember to comment on your code!

We will use the data file **expvalues.txt**.

Remember, the first line defines the different experiments and after that every row is a different gene and its expression (RNA transcript abundance) values. The first column is the gene name, followed by the different experiments. First three experiments are replicates of the **control** experiments and the last three are replicates for the **treatments**. 

### 1. Descriptive Statistics

#### a. Load the file expvalues.txt into R and call it **expvalues**.

```{r}
# Answer here
```

#### b. Create a histogram of all values in the columns **Control1**. Use the argument **breaks=100** in the argument. What can you conclude about the data?

```{r}
# Answer here
```

#### c. Values can be transformed for many reasons. Perform a log transformation by simply taking the **log2()** of the values in the column **Control1** and then create a histogram plot again. What can you conclude about this graph?

```{r}
# Answer here
```

#### d. Now that we are convinced that taking the log2 of the values gives us a better representation of the distribution of the values, create a boxplot using the log2 of all the values. Which two samples look different from the rest? Explain why.

```{r}
# Answer here
```


### 2. Fold change calculation:

#### a. The first three columns are biological replicates of **control** samples and last three columns are **treatment** samples. Create a factor, called **expgroups** to represent this information.

```{r}
# Answer here
```

#### b. Using the original expvalues (not the logged values), calculate the average **treatment** and **control** for each gene. Save the results in a matrix called **expmeans**. You can use loops or apply functions. How many rows and columns are there in expmeans? 


```{r}
# Answer here
```

#### c. For each gene we want to determine how much the expression has changed in the treatment relative to the expression in control. Calculate the ratio of using the treatment and control values in expmeans. Save it in a vector call expratio.

```{r}
# Answer here
```


#### d. Take the log2 of expratio and call it explog2ratio. You have just calculated log fold change. 

```{r}
# Answer here
```

#### e. By taking the log2() of the expratio you have made the values much more symmetric. Positive values mean that original ratio was greater than one (treatment is higher) and a negative value means the ratio was less than one (control was higher). Create a histogram of expratio to confirm.



```{r}
# Answer here
```

#### f. Since our values are in log2 scale, a value of 1 means the change was 2x. So a value of 1 means the value doubled, and value of -1 means the value became half. How many genes have a log2 fold change > 1 OR < -1 ?

```{r}
# Answer here
```
 

#### g. Identify the gene (get the name of the gene) that has the highest explog2ratio and save the name as upGene. A high log fold change means that the expression increased in treatment compared to control.

```{r}
# Answer here
```

#### h. Identify the gene (get the name of the gene) that has the lowest explog2ratio and save it as downGene. The lowest (most negative) log fold change means the original ratio was less than one, which means the treatment value was much lower than the control. So the expression decreased in treatment.

```{r}
# Answer here
```


#### i. Obtain the original expression values of bigGene and smallGene from expvalues and plot them together in a barplot side by side. Explain how the plot validates how your analysis. 

```{r}
# Answer here
```


